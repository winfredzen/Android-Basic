# Gradle插件

想象Gradle是一个平台，具体的构建功能实际上是由 **Gradle 插件**提供的，例如 APK构建、Java代码编译等。

Plugin负责封装、管理并提供Gradle运行期间需要的Task。在工程中依赖某个插件，就能够复用这个插件提供的构建行为。各位平时在工程脚本中所看到的 `apply plugin 'com.android.application'` 、 `apply plugin 'kotlin-android'` ，都是在使用插件去拓展自己工程的构建能力。

可以看到，使用插件可以将代码进行 **模块化** 封装，进而提升功能的 **复用** 能力。

主要有两种类型

- 二进制插件 ***（binary plugins）***
- 脚本插件 ***（script plugins）***

开发者应该根据不同的使用场景，来选择不同的插件形式。二进制插件通常会被发布成复用能力更强的jar包等，可供不同项目工程、不同开发人员之间 **共用** 同一套构建逻辑，常见的Android、Kotlin插件等，这些都属于二进制插件。

脚本插件更多用于对 **当前工程** 的构建逻辑进行配置和拓展，如hook某些任务，做一些构建前后的拷贝、清理工作等。

二者其实可以理解成一个 递进 的关系。由于脚本插件的编写与使用成本较低，一开始通常会使用该类型（除非明确知道功能会被共享复用），若后续代码量变大或者功能需要考虑共享了，那么再考虑包装成二进制插件也是完全没有问题的。



**二进制插件** 

1.声明插件ID与版本号

![051](https://github.com/winfredzen/Android-Basic/blob/master/%E8%BF%9B%E9%98%B6/image/051.png)

2.apply 使用插件，在app子工程的build.gradle

```groovy
// 应用插件
apply plugin: 'com.android.application'
```

3.对插件配置，如：

```groovy
// 配置Android插件所需参数
android {
    compileSdkVersion 29
    buildToolsVersion "29.0.2"
    defaultConfig {
        applicationId "com.imooc.gradle.lifecycle"
        minSdkVersion 15
        targetSdkVersion 29
        versionCode 1
        versionName "1.0"
    }
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile(
                    'proguard-android-optimize.txt'),
                    'proguard-rules.pro'
        }
    }
}
```



**脚本插件**

跟目录下，新建一个`other.gradle`

在app中的build.gradle，中引入

```groovy
apply from: project.rootProject.file("other.gradle")
```









