# 应用程序构建

![034](https://github.com/winfredzen/Android-Basic/blob/master/%E8%BF%9B%E9%98%B6/image/034.png)

**什么是构建？**

构建，用一句话来总结，即“将源代码生成可执行应用程序的过程”

![035](https://github.com/winfredzen/Android-Basic/blob/master/%E8%BF%9B%E9%98%B6/image/035.png)

对应到Android开发领域中，构建即生成APK

**APK构建流程**

这个过程，涉及许多工具和流程。流程包括拷贝、编译、打包、签名、对齐、安装等；工具则包括 javac、kotlinc、d8、aapt2等…

![036](https://github.com/winfredzen/Android-Basic/blob/master/%E8%BF%9B%E9%98%B6/image/036.png)

通常来说有2中方式

1.打包人员一个一个执行命令行（开发人员需要了解整个流程）

2.编写脚本，把流程全部包含起来（脚本适配多个系统？Linux、MacOS）

开发领域引入了**构建工具**的概念，其定义为：一个可编程的工具，能够以 **可执行**和**有序** 的任务来表达满足需要的**自动化**过程。

Gradle基于jvm虚拟机（解决多平台），基于插件（可以分享）。Android官方有很多Gradle插件，如Run



**Gradle优势**：

- 无缝在各个平台运行
- 通过插件，提高构建逻辑复用能力，并具备强大的官方插件库
- 基于Groovy的DSL，提供[声明式](https://baike.baidu.com/item/声明式编程/9939512)的构建语言
- 构建流程定制能力强，可以基于插件、任务、生命周期等纬度进行定制



## Gralde基础

**生成Gradle Wrapper**

切换到项目的根目录，然后运行`gradle wrapper`

![037](https://github.com/winfredzen/Android-Basic/blob/master/%E8%BF%9B%E9%98%B6/image/037.png)



**Gradle的执行**

![038](https://github.com/winfredzen/Android-Basic/blob/master/%E8%BF%9B%E9%98%B6/image/038.png)



在Android Studio中的Terminal使用`./gradlew projects`，可能会提示`zsh: permission denied: ./gradlew`

![039](https://github.com/winfredzen/Android-Basic/blob/master/%E8%BF%9B%E9%98%B6/image/039.png)

可使用`chmod +x gradlew`命令后再使用



另外的一种方式是通过右上角Gradle窗口的 **Execute Gradle Task** 来执行

![040](https://github.com/winfredzen/Android-Basic/blob/master/%E8%BF%9B%E9%98%B6/image/040.png)



**升级降级Gradle**

1.直接修改工程根目录 `gradle/wrapper/gradle-wrapper.properties` 中的 `distributionUrl` 字段即可

2.使用命令如：

```shell
./gradlew wrapper --gradle-version 6.4
```



**快速上手**

在根目录下的`build.gradle`中添加一个打印的命令，如下：

![041](https://github.com/winfredzen/Android-Basic/blob/master/%E8%BF%9B%E9%98%B6/image/041.png)

执行`./gradlew clean -q`命令，有如下的打印

![042](https://github.com/winfredzen/Android-Basic/blob/master/%E8%BF%9B%E9%98%B6/image/042.png)





### Groovy语法

单行注释 //

多行注释 /* */

数据类型 byte short int long float double char

数据定义，如下的两种方式都行：

```groovy
int a = 10
def b = 10

println("a = $a")
println("b = $b")
```

字符串

```groovy
String str = "Hello, " + "World"
String str2 = str.toUpperCase()
println("str = $str2")
```

列表

```groovy
def array = [1, 2, 3, 4]
array.add(5)
//遍历
array.each {
    println("each item is $it")
}
println("array is $array")
```

映射表

```groovy
def map = ["name" : "mooc", "age" : "100"]

println("map is $map")
println("age is ${map["age"]}")
```



循环

```groovy
for (int i = 0; i < 10; i++) {
    println("age is $i")
}
```



方法的定义

```groovy
def hello(String name) {
    println("Hello, $name")
}
hello("wz")
```









































