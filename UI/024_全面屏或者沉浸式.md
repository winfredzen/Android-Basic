# 全面屏或者沉浸式

参考：

+ [控制系统界面可见度](https://developer.android.com/training/system-ui?hl=zh-cn) - 官网



## ActionBar

### 隐藏ActionBar

1.使用style，继承自

```xml
Theme.AppCompat.NoActionBar（暗色主题）
```

或者

```xml
Theme.AppCompat.Light.NoActionBar（亮色主题）
```

2.代码方式

`Activity` 继承自 `AppCompatActivity` 时

```java
getSupportActionBar().hide();//这种方式默认式亮色主题
```

`Activity` 继承自 `Activity` 时

```java
getActionBar().hide();
```

此时，单独隐藏ActionBar的效果如下：

![067](https://github.com/winfredzen/Android-Basic/blob/master/UI/images/067.png)



## 状态栏

参考：

+ [Android沉浸式状态栏，看完这篇就够了！](https://blog.csdn.net/qq_34681580/article/details/103955191)



### 透明状态栏

在上一节隐藏ActionBar的基础上

![069](https://github.com/winfredzen/Android-Basic/blob/master/UI/images/069.png)

如果要实现透明状态栏，可以使用如下的方式：

```java
<item name="android:windowTranslucentStatus">true</item>
或者
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
   getWindow().addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);
}
```

此时的效果如下：

![070](https://github.com/winfredzen/Android-Basic/blob/master/UI/images/070.png)

此时，layout的布局位置就发生了变化，可以使用**`android:fitsSystemWindows="true"`**来恢复padding



同样的道理，设置navigation bar

```java
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
    getWindow().addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_NAVIGATION);
}
或者
<item name="android:windowTranslucentNavigation">true</item>  
```

![071](https://github.com/winfredzen/Android-Basic/blob/master/UI/images/071.png)





## 全面屏

普通手机（非刘海屏）的全面屏，通过在代码中设置如下的方式，即可实现

```java
getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
```

![068](https://github.com/winfredzen/Android-Basic/blob/master/UI/images/068.png)





另外参考：

+ [启用全屏模式](https://developer.android.com/training/system-ui/immersive)



1.向后倾斜

如果只设置`View.SYSTEM_UI_FLAG_FULLSCREEN | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION`

```java
View decorView = getWindow().getDecorView();
decorView.setSystemUiVisibility(View.SYSTEM_UI_FLAG_FULLSCREEN | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION);
```

效果：刚出现时闪一下变为全面屏，点击后，又退出全面屏显示

![072](https://github.com/winfredzen/Android-Basic/blob/master/UI/images/072.gif)





2.沉浸模式

```
        decorView.setSystemUiVisibility(View.SYSTEM_UI_FLAG_IMMERSIVE
                | View.SYSTEM_UI_FLAG_FULLSCREEN
                | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION);
```

如果使用上面的`沉浸模式`，点击屏幕不会退出全面屏显示，但上下滑动时，会退出全面屏显示



3.粘性沉浸模式

```java
        decorView.setSystemUiVisibility(View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY
                | View.SYSTEM_UI_FLAG_FULLSCREEN
                | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION);
```

如果使用上面的`沉浸模式`，点击屏幕不会退出全面屏显示，但上下滑动时，会显示半透明的状态栏和导航栏

![073](https://github.com/winfredzen/Android-Basic/blob/master/UI/images/073.png)





启用全面屏显示：

```java
    @Override
    public void onWindowFocusChanged(boolean hasFocus) {
        super.onWindowFocusChanged(hasFocus);
        if (hasFocus) {
            hideSystemUI();
        }
    }

    private void hideSystemUI() {
        // Enables regular immersive mode.
        // For "lean back" mode, remove SYSTEM_UI_FLAG_IMMERSIVE.
        // Or for "sticky immersive," replace it with SYSTEM_UI_FLAG_IMMERSIVE_STICKY
        View decorView = getWindow().getDecorView();
        decorView.setSystemUiVisibility(
                View.SYSTEM_UI_FLAG_IMMERSIVE
                // Set the content to appear under the system bars so that the
                // content doesn't resize when the system bars hide and show.
                | View.SYSTEM_UI_FLAG_LAYOUT_STABLE
                | View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION
                | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN
                // Hide the nav bar and status bar
                | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION
                | View.SYSTEM_UI_FLAG_FULLSCREEN);
    }

    // Shows the system bars by removing all the flags
    // except for the ones that make the content appear under the system bars.
    private void showSystemUI() {
        View decorView = getWindow().getDecorView();
        decorView.setSystemUiVisibility(
                View.SYSTEM_UI_FLAG_LAYOUT_STABLE
                | View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION
                | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN);
    }
    
```



一些解释，参考：

+ [隐藏导航栏](https://developer.android.com/training/system-ui/navigation?hl=zh-cn)
+ [隐藏状态栏](https://developer.android.com/training/system-ui/status?hl=zh-cn)



> 在 Android 4.1 及更高版本中，您可以将应用的内容设置为显示在状态栏的后面，这样内容大小就不会随着状态栏的隐藏和显示发生调整。 可使用 `SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN` 执行此操作。 您可能还需要使用 `SYSTEM_UI_FLAG_LAYOUT_STABLE` 来帮助您的应用保持稳定布局。



> 在 Android 4.1 及更高版本中，您可以将应用的内容设置为显示在导航栏的后面，这样内容就不会随着导航栏的隐藏和显示调整大小。可使用 `SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION` 执行此操作。 您可能还需要使用 `SYSTEM_UI_FLAG_LAYOUT_STABLE` 来帮助您的应用保持稳定布局。



## 刘海屏

在我本人的oppo打孔屏上，如果是使用上面的全面屏设置，显示效果是这样的：

![074](https://github.com/winfredzen/Android-Basic/blob/master/UI/images/074.png)

上面状态栏的部分是黑色的，而且并没有全面屏显示

参考：

+ [支持刘海屏](https://developer.android.com/guide/topics/display-cutout?hl=zh-cn)



在style中添加

```xml
<item name="android:windowLayoutInDisplayCutoutMode">shortEdges</item>
```

效果如下：

![075](https://github.com/winfredzen/Android-Basic/blob/master/UI/images/075.png)



























