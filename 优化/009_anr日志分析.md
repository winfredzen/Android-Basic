# anr日志分析

参考：

+ [干货：ANR日志分析全面解析](https://segmentfault.com/a/1190000040142277)
+ [填坑之旅 -- ANR](https://juejin.cn/post/7020236465149837325#heading-12)

+ [教你如何分析 Android ANR 问题](https://www.cnblogs.com/huansky/p/13944132.html)



如下的anr日志，开头的部分：

![018](https://github.com/winfredzen/Android-Basic/blob/master/%E4%BC%98%E5%8C%96/images/018.png)



**内存信息**

![019](https://github.com/winfredzen/Android-Basic/blob/master/%E4%BC%98%E5%8C%96/images/019.png)

> ```java
> Total number of allocations 476778　　进程创建到现在一共创建了多少对象
> 
> Total bytes allocated 52MB　进程创建到现在一共申请了多少内存
> 
> Total bytes freed 52MB　　　进程创建到现在一共释放了多少内存
> 
> Free memory 777KB　　　 不扩展堆的情况下可用的内存
> 
> Free memory until GC 777KB　　GC前的可用内存
> 
> Free memory until OOME 383MB　　OOM之前的可用内存
> 
> Total memory 当前总内存（已用+可用）
> 
> Max memory 384MB  进程最多能申请的内存
> ```



另外，除了trace文件中有内存信息，普通的eventlog日志中，也有内存信息（不一定打印）

```java
04-02 22:00:08.195  1531  1544 I am_meminfo: [350937088,41086976,492830720,427937792,291887104]
```

> 以上四个值分别指的是：
>
> - Cached
> - Free,
> - Zram,
> - Kernel,Native
>
> Cached+Free的内存代表着当前整个手机的可用内存，如果值很小，意味着处于内存紧张状态。一般低内存的判定阈值为：4G 内存手机以下阀值：350MB，以上阀值则为：450MB



**堆栈消息**

![020](https://github.com/winfredzen/Android-Basic/blob/master/%E4%BC%98%E5%8C%96/images/020.png)





> main线程处于 BLOCK、WAITING、TIMEWAITING状态，那基本上是函数阻塞导致ANR；
>
> 如果main线程无异常，则应该排查CPU负载和内存环境。





















